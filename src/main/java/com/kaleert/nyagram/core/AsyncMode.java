package com.kaleert.nyagram.core;

import java.lang.annotation.*;

/**
 * Настраивает режим конкурентности для выполнения команды.
 * <p>
 * Позволяет определить, должен ли бот обрабатывать команды от одного пользователя
 * последовательно (гарантируя порядок) или параллельно.
 * </p>
 *
 * @see Mode
 * @since 1.0.0
 */
@Target(ElementType.METHOD)
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface AsyncMode {
    
    /**
     * Режим выполнения.
     *
     * @return выбранный режим {@link Mode}.
     */
    Mode value() default Mode.SEQUENTIAL;

    /**
     * Стратегии выполнения команд.
     */
    enum Mode {
        /**
         * Строгая последовательность (по умолчанию).
         * <p>
         * Команды от одного пользователя (userId) ставятся в очередь и выполняются одна за другой.
         * Это гарантирует потокобезопасность сессии (FSM) и предсказуемый порядок действий.
         * </p>
         */
        SEQUENTIAL,

        /**
         * Параллельное выполнение.
         * <p>
         * Задача сразу уходит в свободный поток, не блокируя очередь пользователя.
         * Рекомендуется для "тяжелых" задач (генерация отчетов, долгие I/O запросы),
         * которые не изменяют состояние FSM.
         * </p>
         */
        CONCURRENT
    }
}